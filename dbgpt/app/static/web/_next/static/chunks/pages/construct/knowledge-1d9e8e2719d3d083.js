(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4554],{45629:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/knowledge",function(){return a(33408)}])},85070:function(e,t,a){"use strict";var n=a(85893);a(67294);var s=a(28459),o=a(92398),l=a(36609),c=a(41156),i=a(9641),d=a(16165),r=a(9020),p=a(92962),m=a(50067),h=a(38545),u=a(82353),x=a(11163);a(66546),t.Z=function(e){let{children:t}=e,a=[{key:"app",name:(0,l.t)("App"),path:"/app",icon:(0,n.jsx)(c.Z,{})},{key:"flow",name:(0,l.t)("awel_flow"),icon:(0,n.jsx)(i.Z,{}),path:"/flow"},{key:"models",name:(0,l.t)("model_manage"),path:"/models",icon:(0,n.jsx)(d.Z,{component:u.IN})},{key:"database",name:(0,l.t)("Database"),icon:(0,n.jsx)(r.Z,{}),path:"/database"},{key:"knowledge",name:(0,l.t)("Knowledge_Space"),icon:(0,n.jsx)(p.Z,{}),path:"/knowledge"},{key:"agent",name:(0,l.t)("Plugins"),path:"/agent",icon:(0,n.jsx)(m.Z,{})},{key:"prompt",name:(0,l.t)("Prompt"),icon:(0,n.jsx)(h.Z,{}),path:"/prompt"}],f=(0,x.useRouter)(),g=f.pathname.split("/")[2];return window.matchMedia("(prefers-color-scheme: dark)").matches,(0,n.jsx)("div",{className:"flex flex-col h-full w-full  dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",children:(0,n.jsx)(s.ZP,{theme:{components:{Button:{},Segmented:{itemSelectedBg:"#2867f5",itemSelectedColor:"white"}}},children:(0,n.jsx)(o.Z,{activeKey:g,items:a.map(e=>({key:e.key,label:e.name,children:t,icon:e.icon})),onTabClick:e=>{f.push("/construct/".concat(e))}})})})}},33408:function(e,t,a){"use strict";a.r(t);var n=a(85893),s=a(91364),o=a(85070),l=a(41468),c=a(76212),i=a(28001),d=a(10283),r=a(69155),p=a(43257),m=a(88700),h=a(28058),u=a(68795),x=a(24969),f=a(14079),g=a(85576),_=a(75081),w=a(79531),j=a(14726),k=a(66309),b=a(3363),y=a(93967),v=a.n(y),S=a(96486),N=a(30381),Z=a.n(N),C=a(11163),T=a(67294),O=a(67421);t.default=()=>{let{setCurrentDialogInfo:e}=(0,T.useContext)(l.p),[t,a]=(0,T.useState)([]),[y,N]=(0,T.useState)(!1),[P,D]=(0,T.useState)(!1),[E,B]=(0,T.useState)(),[K,V]=(0,T.useState)(0),[I,R]=(0,T.useState)(""),[X,A]=(0,T.useState)([]),[H,J]=(0,T.useState)(""),[F,G]=(0,T.useState)(""),[L,M]=(0,T.useState)(!1),[U,W]=(0,T.useState)(null),{t:Y}=(0,O.$G)(),$=[{title:Y("Knowledge_Space_Config")},{title:Y("Choose_a_Datasource_type")},{title:Y("Upload")},{title:Y("Segmentation")}],q=(0,C.useRouter)();async function z(e){M(!0);let[t,n]=await (0,c.Vx)((0,c.Vm)({...e}));M(!1),a(n)}async function Q(){let[e,t]=await (0,c.Vx)((0,c.mB)());if(!t)return null;W(t.storage)}(0,T.useEffect)(()=>{z(),Q()},[]);let ee=async t=>{let[a,n]=await (0,c.Vx)((0,c.sW)({chat_mode:"chat_knowledge"}));(null==n?void 0:n.conv_uid)&&(null==e||e({chat_scene:n.chat_mode,app_code:n.chat_mode}),localStorage.setItem("cur_dialog_info",JSON.stringify({chat_scene:n.chat_mode,app_code:n.chat_mode})),q.push("/chat?scene=chat_knowledge&id=".concat(null==n?void 0:n.conv_uid,"&knowledge_id=").concat(t.id)))},et=e=>{let{label:t,spaceName:a,docType:n,files:s}=e;"finish"===t?(N(!1),z(),R(""),J(""),G("finish"),localStorage.removeItem("cur_space_id")):"forward"===t?(0===K&&z(),V(e=>e+1)):V(e=>e-1),s&&A(s),a&&R(a),n&&J(n)},ea=e=>{g.default.confirm({title:Y("Tips"),icon:(0,n.jsx)(h.Z,{}),content:"".concat(Y("Del_Knowledge_Tips"),"?"),okText:"Yes",okType:"danger",cancelText:"No",async onOk(){await (0,c.Vx)((0,c.XK)({name:null==e?void 0:e.name})),z()}})},en=async e=>{z({name:e.target.value})};return(0,n.jsx)(o.Z,{children:(0,n.jsxs)(_.Z,{spinning:L,children:[(0,n.jsxs)("div",{className:"page-body p-4 md:p-6 h-[90vh] overflow-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(w.default,{variant:"filled",prefix:(0,n.jsx)(u.Z,{}),placeholder:Y("please_enter_the_keywords"),onChange:(0,S.debounce)(en,300),allowClear:!0,className:"w-[230px] h-[40px] border-1 border-white backdrop-filter backdrop-blur-lg bg-white bg-opacity-30 dark:border-[#6f7f95] dark:bg-[#6f7f95] dark:bg-opacity-60"})}),(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(j.ZP,{className:"border-none text-white bg-button-gradient",icon:(0,n.jsx)(x.Z,{}),onClick:()=>{N(!0)},children:Y("create_knowledge")})})]}),(0,n.jsx)("div",{className:"flex flex-wrap mt-4 mx-[-8px]",children:null==t?void 0:t.map(e=>(0,n.jsx)(s.ZP,{onClick:()=>{B(e),D(!0),localStorage.setItem("cur_space_id",JSON.stringify(e.id))},description:e.desc,name:e.name,logo:"/images/knowledge.png",RightTop:(0,n.jsx)(s.ZS,{menu:{items:[{key:"del",label:(0,n.jsx)("span",{className:"text-red-400",onClick:()=>ea(e),children:"删除"})}]}}),rightTopHover:!1,Tags:(0,n.jsx)("div",{children:(0,n.jsx)(k.Z,{children:(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)(f.Z,{className:"mt-[1px]"}),e.docs]})})}),LeftBottom:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("span",{children:e.owner}),(0,n.jsx)("span",{children:"•"}),(null==e?void 0:e.gmt_modified)&&(0,n.jsx)("span",{children:Z()(null==e?void 0:e.gmt_modified).fromNow()+" "+Y("update")})]}),RightBottom:(0,n.jsx)(s.TH,{text:Y("start_chat"),onClick:()=>{ee(e)}})},e.id))})]}),(0,n.jsx)(g.default,{className:"h-5/6 overflow-hidden",open:P,width:"70%",onCancel:()=>D(!1),footer:null,destroyOnClose:!0,children:(0,n.jsx)(i.Z,{space:E,onAddDoc:function(e){R(e),V(1),N(!0),G("start")},onDeleteDoc:z,addStatus:F})}),(0,n.jsxs)(g.default,{title:"新增知识库",centered:!0,open:y,destroyOnClose:!0,onCancel:()=>{N(!1)},width:1e3,afterClose:()=>{V(0),z()},footer:null,children:[(0,n.jsx)(b.Z,{current:K,items:$}),0===K&&(0,n.jsx)(m.Z,{handleStepChange:et,spaceConfig:U}),1===K&&(0,n.jsx)(d.Z,{handleStepChange:et}),(0,n.jsx)(r.Z,{className:v()({hidden:2!==K}),spaceName:I,docType:H,handleStepChange:et}),3===K&&(0,n.jsx)(p.Z,{spaceName:I,docType:H,uploadFiles:X,handleStepChange:et})]})]})})}},66546:function(){}},function(e){e.O(0,[3662,7034,7779,3791,7656,2913,5081,8791,1203,6184,9859,2850,2398,4567,9169,1980,418,7434,8047,3106,5265,2783,3761,7582,9946,7263,1696,7906,9071,342,9774,2888,179],function(){return e(e.s=45629)}),_N_E=e.O()}]);